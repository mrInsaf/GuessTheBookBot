import re

# Список персонажей (из вашего описания)
characters = [
    "Антон Антонович Сквозник-Дмухановский",
    "Анна Андреевна",
    "Марья Антоновна",
    "Лука Лукич Хлопов",
    "Аммос Федорович Ляпкин-Тяпкин",
    "Артемий Филиппович Земляника",
    "Иван Кузьмич Шпекин",
    "Петр Иванович Добчинский",
    "Петр Иванович Бобчинский",
    "Иван Александрович Хлестаков",
    "Осип",
    "Христиан Иванович Гибнер",
    "Федор Андреевич Люлюков",
    "Иван Лазаревич Растаковский",
    "Степан Иванович Коробкин",
    "Степан Ильич Уховертов",
    "Свистунов",
    "Пуговицын",
    "Держиморда",
    "Абдулин",
    "Февронья Петровна Пошлепкина",
    "Жена унтер-офицера",
    "Мишка",
    "Слуга трактирный",
    "Жена его",  # для жены Хлопова и др.
    "Гости и гостьи, купцы, мещане, просители"
]

# Добавим упрощённые формы: имена, фамилии, отчества — чтобы охватить все варианты
additional_forms = [
    "Антон", "Антонович", "Сквозник-Дмухановский", "Анна", "Андреевна",
    "Марья", "Лука", "Лукич", "Хлопов", "Аммос", "Федорович", "Ляпкин-Тяпкин",
    "Артемий", "Филиппович", "Земляника", "Иван", "Кузьмич", "Шпекин",
    "Петр", "Иванович", "Добчинский", "Бобчинский", "Александрович", "Хлестаков",
    "Осип", "Христиан", "Гибнер", "Федор", "Андреевич", "Люлюков", "Лазаревич",
    "Растаковский", "Степан", "Коробкин", "Ильич", "Уховертов", "Свистунов",
    "Пуговицын", "Держиморда", "Абдулин", "Февронья", "Петровна", "Пошлепкина",
    "Жена", "унтер-офицера", "его", "Слуга", "трактирный", "Гости", "и",
    "гостьи", "купцы", "мещане", "просители"
]

# Объединяем и сортируем по длине (сначала самые длинные — чтобы не было частичных совпадений)
all_names = sorted(characters + additional_forms, key=len, reverse=True)

# Экранируем и делаем регулярное выражение: ищем полное слово (но не внутри других слов)
# Используем \b — границы слов, но для кириллицы лучше использовать (?<!\w) и (?!\w)
escaped_fragments = [re.escape(frag) for frag in all_names]
pattern_str = r'(?<!\w)(' + '|'.join(escaped_fragments) + r')(?!\w)'
pattern = re.compile(pattern_str, re.IGNORECASE)

# Имя файла
input_file = 'avidreaders.ru__revizor.txt'  # замените на ваш файл

# Чтение
try:
    with open(input_file, 'r', encoding='utf-8') as file:
        lines = file.readlines()
except FileNotFoundError:
    print(f"Файл {input_file} не найден.")
    exit()

output_lines = []
for line in lines:
    # Заменяем все вхождения имён на ###
    new_line = pattern.sub('###', line)
    output_lines.append(new_line)


# Чтобы сохранить в файл:
with open('output.txt', 'w', encoding='utf-8') as file:
    file.writelines(output_lines)